{% schema %}
{
	"name": "Testimonial",
	"tag": "section",
	"class": "s-testimonial p-x-md p-y-section f-v f-a-c",
	"presets": [
		{
			"name": "Testimonial",
			"settings": {
				"heading": "Institutionally recognized",
				"logo": "shopify://shop_images/UC-Davis-logo.png"
			},
			"blocks": [
				{
					"type": "testimonial",
					"settings": {
						"quote": "Beyond muscle growth, protein plays a vital role in immune function and metabolic health. The high-efficacy of P24 makes it a great option to support overall well-being of the average population, not just athletic performance.",
						"name": "Dr. Jon Doe",
						"position": "Head of Nutritional Psychiatry at Tufts University"
					}
				},
				{
					"type": "testimonial",
					"settings": {
						"quote": "P24 stands out not only for its clean formulation but for its absorption efficiency. In my clinical experience, this has made a noticeable difference in patient energy levels and post-exercise recoveryâ€”even in non-athletes.",
						"name": "Dr. Maria Chen",
						"position": "Clinical Nutritionist and Lecturer, Stanford School of Medicine"
					}
				},
				{
					"type": "testimonial",
					"settings": {
						"quote": "P24 fills a critical gap for those with busy lifestyles. Its high bioavailability and clean amino acid profile make it one of the best choices for anyone seeking consistent energy, better immune regulation, and healthy aging.",
						"name": "Dr. Lisa Moretti",
						"position": "Director of Preventive Health, Columbia Medical Center"
					}
				}
			]
		}
	],
	"settings": [
		{
			"type": "text",
			"id": "heading",
			"label": "Heading",
			"default": "Institutionally recognized"
		},
		{
			"type": "image_picker",
			"id": "logo",
			"label": "Logo"
		},
		{
			"type": "checkbox",
			"id": "show_testimonial_content",
			"label": "Show Testimonial Content",
			"default": true
		}
	],
	"blocks": [
		{
			"type": "testimonial",
			"name": "Testimonial",
			"settings": [
				{
					"type": "textarea",
					"id": "quote",
					"label": "Quote"
				},
				{
					"type": "text",
					"id": "name",
					"label": "Name"
				},
				{
					"type": "text",
					"id": "position",
					"label": "Position"
				}
			]
		}
	]
}
{% endschema %}

{%- liquid
	assign heading = section.settings.heading
	assign logo = section.settings.logo
	assign show_testimonial_content = section.settings.show_testimonial_content
	assign testimonials = section.blocks
-%}
{%- if testimonials.size > 0 -%}
	{%- capture slider_html -%}
		{%- for i in testimonials -%}
			{%- liquid
				assign quote = i.settings.quote
				assign name = i.settings.name
				assign position = i.settings.position
			-%}
				{%- if quote != blank -%}
					<div class="s-testimonial__block c-slider__slide">
						<p class="s-testimonial__quote t-b-1">{{ quote }}</p>
						{%- if name != blank -%}
							<p class="s-testimonial__name t-h-4">{{ name }}</p>
						{%- endif -%}

						{%- if position != blank -%}
							<p class="btn-square t-l-4">{{ position }}</p>
						{%- endif -%}
					</div>
				{%- endif -%}
		{%- endfor -%}
	{%- endcapture -%}

	{%- render 'c-slider',
		classes: 's-testimonial__blocks',
		slider_html: slider_html,
		custom_slides_size: '--slide-size: 100%;',
		slider_options: "{'loop': true, 'watchDrag': true}",
		enable_nav: true,
		enable_wheel: true
	-%}

	{%- if show_testimonial_content -%}
		{%- if heading != blank or logo != null -%}
			<div class="s-testimonial__content f-v f-a-c t-uppercase">
				{%- if heading != blank -%}
					<h2 class="s-testimonial__heading t-b-3">{{ heading }}</h2>
				{%- endif -%}

				{%- if logo != null -%}
					<div class="s-testimonial__logo child-contain">
						{%- render 'c-img-srcset', image: logo, alt: logo.alt -%}
					</div>
				{%- endif -%}
			</div>
		{%- endif -%}
	{%- endif -%}
{%- endif -%}
