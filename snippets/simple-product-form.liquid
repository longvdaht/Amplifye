{%- liquid
    assign selected_variant = product.selected_or_first_available_variant
    assign is_default_to_subscription = true
    assign subscription = item.selling_plan_groups
    assign subscription_price_adj = subscription[0].selling_plans[0].price_adjustments[0].value
    
    if code == blank
        assign code = 'MBG15'
    endif

    if is_default_to_subscription
        assign subscription_price_adj_perc = 100 | minus: subscription_price_adj | divided_by: 100.00
    endif
-%}
<style>
  .simple-product-form .c-product-form[data-available=true] [type=submit] span:not(.form-state-available) {
    display: block;
  }
</style>
<form
    class="c-product-form"
    action="{{- routes.cart_add_url -}}"
    method="post"
    enctype="multipart/form-data"
    data-available="{{- selected_variant.available -}}"
    data-update-variant-url="{{- is_update_variant_url | default: false -}}"
    data-update-variant-disabled-state="{{- is_update_variant_disabled_state | default: false -}}"
    {% render 'c-product-variants-json', item_product: product -%}
>
    {%- if product.has_only_default_variant == false -%}
        <div class="c-product-form__variants">
            {% render 'c-item-variants',
                item: selected_variant,
                is_show_selected_variant_in_label: true,
                is_variant_pills: true
            %}
        </div>
    {%- endif -%}

    {%- if has_quantity_selector == true -%}
        <div class="c-product-form__quantity">
            {%- render 'c-item-quantity', item: selected_variant -%}
        </div>
    {%- endif -%}

    <input
        type="hidden"
        name="id"
        value="{{ selected_variant.id }}"
    >
    <input
        type="hidden"
        name="code"
        value="{{ code }}"
    >
  
    {% if btn_outline %}
      <button class="btn-outline c-product-form__cta js-form-submit" type="submit">
          <span class="btn-outline__label">{{- cta_label -}}</span>
      </button>
    {% else %}
      <button
          class="c-product-form__cta btn js-form-submit {{ button_class }}"
          type="submit"
          {%- if selected_variant.available == false %}
              disabled
          {%- endif -%}
      >
          <span class="form-state-available">{{ cta_label }}</span>
      </button>
    {% endif %}

    {%- if product.gift_card? and template.name == 'product' -%}
        {%- render 'c-gift-card-recipient-form' -%}
    {%- endif -%}
</form>